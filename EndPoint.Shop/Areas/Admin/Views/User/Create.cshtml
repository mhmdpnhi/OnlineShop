@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    ViewData["Title"] = "Create";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}

<div class="pagetitle">
    <h1>ایجاد کاربر جدید</h1>
    <nav>
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">ادمین</a></li>
            <li class="breadcrumb-item"><a href="~/Admin/User/Index">کاربران</a></li>
            <li class="breadcrumb-item active"><a href="~/Admin/User/Create">ایجاد کاربر</a></li>
        </ol>
    </nav>
</div><!-- End Page Title -->

<section class="section">
    <div class="row">
        <div class="col-lg-12">

            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">کاربر جدید</h5>

                    <!-- Form Elements -->
                    <form>

                        <div class="row mb-3">
                            <label class="col-sm-2 col-form-label">اطلاعات را وارد نمایید</label>
                            <div class="col-sm-10">
                                <div class="input-group mb-3">
                                    <span class="input-group-text" id="addon1">@@</span>
                                    <input type="text" class="form-control" placeholder="نام کاربری" aria-label="Username" aria-describedby="addon1" id="UserNameForm">
                                </div>
                                <div class="form-floating mb-3">
                                    <input type="email" class="form-control" id="Email" placeholder="email@example.com">
                                    <label for="Email">ایمیل</label>
                                </div>
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="Phone" placeholder="+98" aria-label="Phone" aria-describedby="addon2">
                                    <label for="Phone">شماره همراه</label>
                                </div>
                                <div class="form-floating mb-3">
                                    <input type="password" class="form-control" id="Password" placeholder="Password">
                                    <label for="Password">رمز عبور</label>
                                </div>
                                <div class="form-floating mb-3">
                                    <select class="form-select" id="Role" aria-label="select a role" asp-items="@ViewBag.Roles">
                                        <option selected>یک نقش انتخاب کنید</option>
                                    </select>
                                    <label for="Role">نقش</label>
                                </div>

                                <a onclick="RegisterUser()" class="btn btn-primary">ایجاد کاربر</a>

                            </div>
                        </div>

                    </form><!-- End General Form Elements -->

                </div>
            </div>

        </div>
    </div>
</section>

@section Scripts
{
    <link href="~/lib/Sweetalert2/sweetalert2.min.css" rel="stylesheet" />
    <script src="~/lib/Sweetalert2/sweetalert2.min.js"></script>

    <script>
        function RegisterUser() {
            swal.fire({
                title: 'ایجاد کاربر جدید',
                text: "آیا میخواهید ثبت نام کاربر را انجام دهید؟",
                icon: 'info',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'بله ثبت نام انجام شود',
                cancelButtonText: 'خیر'
            }).then((result) => {
                if (result.value) {

                    var userName = $("#UserNameForm").val();
                    var email = $("#Email").val();
                    var roleId = $("#Role").val();
                    var password = $("#Password").val();
                    var phone = $("#Phone").val();

                    var postData = {
                        'userName': userName,
                        'email': email,
                        'roleId': roleId,
                        'password': password,
                        'phoneNumber': phone,
                    };

                    $.ajax({
                        contentType: 'application/x-www-form-urlencoded',
                        dataType: 'json',
                        type: "POST",
                        url: "Create",
                        data: postData,
                        success: function (data) {
                            if (data.isSuccess == true) {
                                swal.fire(
                                    'موفق!',
                                    data.message,
                                    'success'
                                ).then(function (isConfirm) {
                                    location.reload();
                                });


                            }
                            else {

                                swal.fire(
                                    'هشدار!',
                                    data.message,
                                    'warning'
                                );

                            }
                        },
                        error: function (request, status, error) {
                            alert(request.responseText);
                        }

                    });

                }
            })
        }
    </script>
}